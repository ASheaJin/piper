<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Piper后台管理系统</title>
<link rel="stylesheet" th:href="@{/layui/css/layui.css}">
</head>
<body class="layui-layout-body">
	<div class="layui-layout layui-layout-admin">
		<div data-th-replace="~{layout :: header}"></div>
		<div class="layui-body" style="left: 10px;top:10px">
			<!-- 内容主体区域 -->
			<div>
				<form id="searchFrom" class="layui-form layui-form-pane" th:action="@{/manage/list}" method="post">
					<div class="layui-inline">
						<label class="layui-form-label">时间</label>
						<div class="layui-input-inline" style="width: 300px;">
							<input id="createTime" name="createTime" placeholder="开始时间 至 截止时间" class="layui-input"
								   th:value="${createTime != null ? createTime : ''}" maxlength="30">
						</div>
					</div>
					<button type="submit" class="layui-btn">查询</button>
				</form>
			</div>
			<table class="layui-table">
				<colgroup>
					<col width="100">
					<col width="200">
					<col>
				</colgroup>
				<thead>
					<tr>
						<th><b>顺序号</b></th>
						<th><b>统计项</b></th>
						<th><b>数量</b></th>
						<th><b>详情</b></th>
					</tr>
				</thead>
				<tbody>
					<tr data-th-each="item, iterStat : ${data}">
						<td data-th-text="${iterStat.count}+${pageIndex-1}*${pageSize}"></td>
						<td data-th-text="${item.name}"></td>
						<td data-th-text="${item.datacount}"></td>
						<td>
                            <a class="layui-btn layui-btn-xs" th:href= "${item.url}">查看详情</a>

                        </td>
					</tr>
				</tbody>
			</table>

			<!--<div id="pageContent"></div>-->
		</div>

		<div class="layui-footer">
			<!-- 底部固定区域 -->

		</div>
	</div>
	<!-- <script src="/layui/jquery.min.js"></script>
<script src="/layui/layui.js"></script> -->
<script th:inline="javascript">
    //JavaScript代码区域
    var contextRoot = /*[[@{/}]]*/ '';
    layui.use('laypage', function () {
        var laypage = layui.laypage;
        //执行一个laypage实例
        laypage.render({
            elem: 'pageContent'
            , count: [[${total}]] //数据总数，从服务端得到
            , curr: [[${pageIndex}]]
            , layout: ['count', 'prev', 'page', 'next', 'skip']
            , jump: function (obj, first) {
                console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                console.log(obj.limit); //得到每页显示的条数
                //首次不执行
                if(!first || [[${pageIndex}]] != obj.curr){
            window.location.href = contextRoot+'/manage/list?pageIndex=' + obj.curr + "&pageSize=" + obj.limit +
                "&" + $("#searchFrom").serialize();
        }
            }
        });
    });
    layui.use('laydate', function() {
        var laydate = layui.laydate;
        laydate.render({
            elem : '#createTime' //指定元素
            ,format:'yyyy-MM-dd HH:mm:ss'
            ,type:'datetime'
            ,min: '2019-1-1'
            ,max: '3000-1-1'
            ,theme: '#698B69'
            ,range:"至"
            ,calendar: true

        });
    });
function listSub(url) {
    layer.open({
        type: 2,
        resize:false,
        title: "订阅列表",
        area: ['90%',"90%"],
        content: url
    });
}

function listContent(publisherId) {
    layer.open({
        type: 2,
        resize:false,
        title: "文章列表",
        area: ['90%',"90%"],
        content: "/manage/content/list?publisherId=" + publisherId
    });
}
</script>
</body>
<script type="text/javascript" th:src="@{/common.js}"></script>
</html>